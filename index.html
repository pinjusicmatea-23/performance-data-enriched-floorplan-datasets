<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architectural Dataset</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/menu.css">
    <link rel="stylesheet" href="css/graph-viewer.css">
    <link rel="stylesheet" href="css/ifc-viewer.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Three.js CDN for 3D rendering -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r157/three.min.js"></script>
    
    <!-- Simple Scroll Animations -->
    <style>
        .scroll-animate {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease, transform 0.6s ease;
            will-change: opacity, transform;
        }
        
        .scroll-animate.visible {
            opacity: 1;
            transform: translateY(0);
            will-change: auto;
        }
        
        .scroll-animate-delay {
            transition-delay: 0.15s;
        }
        
        .scroll-animate-delay-2 {
            transition-delay: 0.3s;
        }
        
        .scroll-animate-delay-3 {
            transition-delay: 0.45s;
        }
        
        /* Reduce animations on slow devices */
        @media (prefers-reduced-motion: reduce) {
            .scroll-animate {
                transition: none;
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- Header with hamburger menu -->
    <header class="header">
        <div class="container">
            <div class="logo" style="display: flex; align-items: center;">
                <img src="images/logo3.jpg" alt="Archiset Logo" loading="eager" style="height: 40px; margin-right: 10px;">
                <h1>Archiset</h1>
            </div>
            <nav class="nav" id="nav">
                <ul class="nav-list">
                    <li><a href="#home" class="nav-link">Home</a></li>
                    <li><a href="pages/about.html" class="nav-link">About</a></li>
                    <li><a href="pages/contact.html" class="nav-link">Contact</a></li>
                    <li><a href="#download" class="nav-link">Download Dataset</a></li>
                </ul>
            </nav>
            <button class="hamburger" id="hamburger" aria-label="Toggle navigation">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
        </div>
    </header>

    <!-- Main content -->
    <main>
        <!-- Full-screen Hero section with video background -->
        <section id="home" class="hero">
            <!-- Background video -->
            <video autoplay muted loop playsinline preload="metadata" class="hero-video">
                <source src="images/home_frame.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            
            <!-- Hero content overlay -->
            <div class="hero-overlay"></div>
            <div class="hero-content">
                <div class="container">
                    <h1>Explore Architectural Data</h1>
                    <p>Discover and analyze comprehensive architectural datasets with interactive visualizations and downloadable resources.</p>
                    <div class="hero-buttons">
                        <a href="#graphs" class="btn btn-primary">View Visualizations</a>
                        <a href="#ifc-models" class="btn btn-primary">Explore 3D Models</a>
                        <a href="#download" class="btn btn-secondary">Download Dataset</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Project Information Section -->
        <section id="project-info" class="project-info-section">
            <div class="container">
                <h2 class="scroll-animate">Project Workflow</h2>
                <p class="workflow-intro scroll-animate">This research project presents a comprehensive methodology for enriching architectural datasets with performance data. Our workflow integrates IFC building models with energy and daylight analysis to create enhanced datasets for machine learning and architectural research in multiple formats.</p>
                
                <!-- Full-width Workflow Image -->
                <div class="workflow-image-fullwidth scroll-animate">
                    <img src="images/workflow.png" alt="Project Workflow Diagram" class="workflow-diagram-fullwidth" id="workflow-image" loading="lazy">
                    <p class="image-caption">Comprehensive workflow for performance data enriched floorplan datasets</p>
                </div>
                
                <!-- Project Highlights Cards -->
                <div class="project-highlights">
                    <div class="highlight-item scroll-animate">
                        <h3>IFC Authoring</h3>
                        <p>Using the Geometry Gym plugin, GH trees are mapped to the correct IFC hierarchy (Project → Site → Building → Storey → Elements), ensuring semantic validity and robust relationships for downstream queries.</p>
                    </div>
                    <div class="highlight-item scroll-animate scroll-animate-delay">
                        <h3>Geolocation & Climate Context</h3>
                        <p>Using the CityWeft API, models are placed in real-world contexts. 10 climate zones are defined and candidate locations pre-selected. A positioning script matches each building to an optimal site based on typology, window distribution, and height.</p>
                    </div>
                    <div class="highlight-item scroll-animate scroll-animate-delay-2">
                        <h3>Performance Simulations</h3>
                        <p>Solar radiation, daylight, and energy studies are conducted. Results are stored at the appropriate granularity (room, window, apartment).</p>
                    </div>
                    <div class="highlight-item scroll-animate scroll-animate-delay-3">
                        <h3>Data Embedding & Structuring</h3>
                        <p>Simulation outputs are written back into IFC as custom properties and exported in structured CSV/XML to support analytics and ML pipelines. Rich building graphs are also generated from these enriched IFCs.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- GLB Models Grid Section -->
        <section id="ifc-models" class="ifc-section">
            <div class="container">
                <h2>Models preview</h2>
                
                <!-- GLB Grid Viewer Container -->
                <div class="ifc-viewer-container">
                    <iframe 
                        id="ifc-viewer-frame" 
                        class="ifc-viewer-frame" 
                        src="viewers/grid-glb-viewer.html"
                        loading="lazy"
                        title="GLB Models Grid Viewer - IAAC Performance Dataset">
                    </iframe>
                </div>


            </div>
        </section>

        <!-- Interactive Graphs Section -->
        <section id="graphs" class="graphs-section">
            <div class="container">
                <h2>Interactive Visualizations</h2>
                <p>Explore architectural adjacency graphs showing spatial relationships within buildings. Pan, zoom, and interact with graph visualizations.</p>
                <div class="graph-container">
                    <div class="graph-viewer" id="graph-viewer">
                        <div class="graph-placeholder">
                            <p><strong>Loading Building 1006 Adjacency Graph...</strong></p>
                            <p>37+ architectural adjacency graphs available</p>
                            <p>Auto-loading sample visualization on page load</p>
                            <p>Supported features:</p>
                            <ul style="text-align: left; margin-top: 1rem;">
                                <li>Pan and zoom with mouse/touch</li>
                                <li>Search graphs by building number</li>
                                <li>Filter by graph type</li>
                                <li>Random graph exploration</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Data Preview Section -->
        <section id="data-preview" class="data-section">
            <div class="container">
                <h2>Dataset Explorer</h2>
                <p>Interactive preview and filtering of architectural data. Choose your ranges.</p>
                
                <div class="data-container">
                    <!-- Query Interface -->
                    <div class="query-panel">
                        <div class="query-controls">
                            <div class="advanced-filter-container-fullwidth">
                                <div class="filter-selector">
                                    <button type="button" class="dropdown-toggle" id="column-selector-toggle" onclick="toggleColumnSelector()">
                                        <span>Select Columns to Filter</span>
                                        <span class="dropdown-arrow">▼</span>
                                    </button>
                                    <div class="column-dropdown" id="column-dropdown" style="display: none;">
                                        <div class="dataset-section" data-dataset="building">
                                            <h4>Building Info</h4>
                                            <div class="column-list" id="building-columns"></div>
                                        </div>
                                        <div class="dataset-section" data-dataset="rooms">
                                            <h4>Rooms Data</h4>
                                            <div class="column-list" id="rooms-columns"></div>
                                        </div>
                                        <div class="dataset-section" data-dataset="windows">
                                            <h4>Windows Data</h4>
                                            <div class="column-list" id="windows-columns"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="active-filters" id="active-filters">
                                    <div class="filter-instructions">Select columns above to add filters</div>
                                </div>
                                <div class="filter-actions">
                                    <button class="btn secondary" id="apply-filters-btn" onclick="applyAdvancedFilters()">
                                        <span class="btn-text">Apply Filters</span>
                                        <span class="btn-loading" style="display: none;">Filtering...</span>
                                    </button>
                                    <button class="btn secondary" onclick="clearAllFilters()">Clear All</button>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Data Table -->
                    <div class="data-preview-container">
                        <div class="data-header">
                            <h4>Dataset Preview</h4>
                            <div class="data-actions">
                                <button class="btn secondary" onclick="exportFilteredData('csv')">Export CSV</button>
                                <button class="btn secondary" onclick="exportFilteredData('all')">Export All Datasets</button>
                                <span id="row-count" class="row-counter">Loading...</span>
                            </div>
                        </div>
                        
                        <div class="table-container" id="data-table-container">
                            <p>Dataset will load here...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Download Section -->
        <section id="download" class="download-section">
            <div class="container">
                <h2>Download Dataset</h2>
                <p>Access comprehensive architectural dataset for research and analysis.</p>
                <div class="download-grid">
                    <div class="download-item">
                        <h3>Full Dataset</h3>
                        <p>Complete architectural dataset with all measurements and metadata.</p>
                        <button class="btn btn-download" onclick="downloadFullDataset()">Download All</button>
                    </div>
                    <div class="download-item">
                        <h3>CSV Dataset</h3>
                        <p>Complete dataset in CSV format for data analysis and research.</p>
                        <a href="datasets/csv-dataset.zip" class="btn btn-download" download>Download ZIP</a>
                    </div>
                    <div class="download-item">
                        <h3>Documentation</h3>
                        <p>Data dictionary and usage guidelines.</p>
                        <a href="datasets/documentation.pdf" class="btn btn-download" download>Download PDF</a>
                    </div>
                    <div class="download-item">
                        <h3>Swiss Dwellings</h3>
                        <p>Original Swiss residential building dataset used as foundation.</p>
                        <a href="datasets/swiss-dwellings-v3.0.0.zip" class="btn btn-download" download>Download ZIP</a>
                    </div>
                    <div class="download-item">
                        <h3>IFC</h3>
                        <p>3D building information models in Industry Foundation Classes format.</p>
                        <a href="datasets/ifc.zip" class="btn btn-download" download>Download ZIP</a>
                    </div>
                    <div class="download-item">
                        <h3>Graphs</h3>
                        <p>Interactive adjacency graphs and network visualizations.</p>
                        <a href="datasets/graphs.zip" class="btn btn-download" download>Download ZIP</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Workflow Process Section -->
        <section id="workflow-process" class="workflow-process-section">
            <div class="container">
                <h2 class="scroll-animate">Dataset Creation Process</h2>
                <p class="scroll-animate">Dataset enhancement workflow consists of multiple stages, each building upon established architectural processes and simulation methodologies.</p>
                
                <div class="process-steps">
                    <div class="process-step scroll-animate">
                        <div class="step-number">01</div>
                        <div class="step-content">
                            <h3>Foundation Dataset: Swiss Dwellings</h3>
                            <p>A large dataset of real apartment models saved in csv which can be recreated as geometry using Python.</p>
                            <div class="step-details">
                                <ul>
                                    <li>3,000+ residential building units</li>
                                    <li>Detailed room-level spatial data</li>
                                    <li>Authentic Swiss architectural typologies</li>
                                    <li>Custom python node for CSV to geometry</li>
                                </ul>
                                <a href="https://zenodo.org/records/7788422" class="btn btn-secondary" target="_blank" rel="noopener">View Original Dataset →</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="process-step scroll-animate scroll-animate-delay">
                        <div class="step-number">02</div>
                        <div class="step-content">
                            <h3>3D Model</h3>
                            <p>IFC models created with precision and enhanced properties for comprehensive building information modeling.</p>
                            <div class="step-details">
                                <ul>
                                    <li>IFC models with Geometry Gym</li>
                                    <li>Adding properties to IFC</li>
                                    <li>Precise geometry</li>
                                </ul>
                                <a href="https://geometrygym.wordpress.com/" class="btn btn-secondary" target="_blank" rel="noopener">Visit Geometry Gym →</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="process-step scroll-animate scroll-animate-delay-2">
                        <div class="step-number">03</div>
                        <div class="step-content">
                            <h3>Real World Context</h3>
                            <p>Integration with real-world environmental data to provide comprehensive contextual information for each building.</p>
                            <div class="step-details">
                                <ul>
                                    <li>CityWeft API integration</li>
                                    <li>10 climates/cities coverage</li>
                                    <li>Matching building characteristics with city</li>
                                </ul>
                                <a href="https://www.cityweft.com/" class="btn btn-secondary" target="_blank" rel="noopener">Visit CityWeft →</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="process-step scroll-animate scroll-animate-delay-3">
                        <div class="step-number">04</div>
                        <div class="step-content">
                            <h3>Performance Simulation</h3>
                            <p>Each building geometry underwent comprehensive environmental performance analysis using industry-standard simulation tools.</p>
                            <div class="step-details">
                                <ul>
                                    <li>Energy demand calculations across climate zones</li>
                                    <li>Daylight factor analysis with high-resolution sensor grids</li>
                                    <li>Solar radiation and sun hour modeling</li>
                                    <li>Window performance optimization studies</li>
                                </ul>
                                <a href="https://www.pollination.solutions/rhino-plugin" class="btn btn-secondary" target="_blank" rel="noopener">Visit Pollination →</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="process-step scroll-animate">
                        <div class="step-number">05</div>
                        <div class="step-content">
                            <h3>Data Enhancement & Integration</h3>
                            <p>Raw simulation outputs were processed, validated, and integrated with spatial data to create our enriched architectural dataset.</p>
                            <div class="step-details">
                                <ul>
                                    <li>Automated data validation and quality control</li>
                                    <li>Graph network generation for ML applications</li>
                                    <li>Multi-format export (CSV, IFC, JSON)</li>
                                    <li>Interactive visualization creation</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Fullscreen Image Modal -->
    <div id="fullscreen-modal" class="fullscreen-modal" onclick="closeFullscreenImage()">
        <span class="close-fullscreen">&times;</span>
        <img id="fullscreen-image" class="fullscreen-content">
        <div class="fullscreen-caption"></div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Joaquín Broquedis, Marco Durand, Matea Pinjušić. Master's Thesis Project - IAAC. All rights reserved.</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="js/dataset-explorer.js"></script>
    <script src="js/main.js"></script>
    <script src="js/performance-optimizer.js"></script>
    <script src="js/graph-viewer.js"></script>
    <script src="js/enhanced-graph-loader.js"></script>
    <script src="js/graph-manager.js"></script>
    
    <!-- Simple Scroll Animation Script -->
    <script>
        // Throttle function to limit observer callbacks
        function throttle(func, limit) {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            }
        }
        
        // Intersection Observer for scroll animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -30px 0px'
        };
        
        const observer = new IntersectionObserver(throttle((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    // Stop observing once animated to improve performance
                    observer.unobserve(entry.target);
                }
            });
        }, 100), observerOptions);
        
        // Observe all elements with scroll-animate class
        document.addEventListener('DOMContentLoaded', () => {
            // Check for reduced motion preference
            if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                return; // Skip animations for users who prefer reduced motion
            }
            
            const animateElements = document.querySelectorAll('.scroll-animate');
            animateElements.forEach(el => observer.observe(el));
        });
        
        // Function to download all dataset files
        function downloadFullDataset() {
            const files = [
                'datasets/csv-dataset.zip',
                'datasets/documentation.pdf',
                'datasets/swiss-dwellings-v3.0.0.zip',
                'datasets/ifc.zip',
                'datasets/graphs.zip'
            ];
            
            // Download each file with a small delay to prevent browser blocking
            files.forEach((file, index) => {
                setTimeout(() => {
                    const link = document.createElement('a');
                    link.href = file;
                    link.download = '';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }, index * 500); // 500ms delay between downloads
            });
        }
    </script>
</body>
</html>